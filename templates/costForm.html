<div class="cost_details clrfix">
	<div class="left_side_bar">
		
		<ul>
			
			<li>
				<a  ui-sref="dashboard.orders.details({id:orderId,code:orderCode})"><i class="fa fa-file-text-o"></i>订单详情 </a>
			</li>

			<li >
				<a ui-sref="dashboard.orders.report({id:orderId,code:orderCode})">
				<i class="fa fa-list-alt"></i>量房报告 </a>
			</li>

			<li ng-if="roleCode==11 || roleCode==12 || roleCode==13 || roleCode==14">
				<a ui-sref="dashboard.orders.bom({id:orderId,code:orderCode})"><i class="fa fa-list-ol"></i>物料清单</a>
			</li>			

			<li>
				<a ui-sref="dashboard.orders.design({id:orderId,code:orderCode})"><i class="fa fa-file-picture-o"></i>设计图</a>
			</li>

			<li ng-if="roleCode==11 || roleCode==12 || roleCode==13 || roleCode==14">
				<a ui-sref="dashboard.orders.workload({id:orderId,code:orderCode})"><i class="fa fa-tasks"></i>工程量</a>
			</li>
			<li ng-if="roleCode==16">
				<a ui-sref="dashboard.orders.costForm({id:orderId,code:orderCode})">
				<i class="fa fa-bar-chart fa-2"></i>成本控制单</a>
			</li>			

		</ul>
	</div>

	<div class="cost_detail_info main_content" ng-if="!hasSubmit">

		<ol class="breadcrumb">
			<li>
				<a ui-sref="dashboard.orders({id:orderId,code:orderCode})">我的订单</a><i class="fa fa-angle-right"></i>
			</li><li class="active">
				<a ui-sref="dashboard.orders.details({id:orderId,code:orderCode})">{{currentProject}}<i class="fa fa-angle-right"></i></a>
			</li><li class="active">
				成本控制单</a>
			</li>
		</ol>	
		<h3>生命屋装修成本控制单 </h3>
		<p>
			<span>项目编号：{{data.decorationTask.decorationTaskCode}}</span>&nbsp;
			<span>项目名称：{{data.decorationTask.projectName}}</span>
		</p>
		<table class="table table-bordered">
			<!-- <th colspan="8" class="tabletitle">量房记录表</th> -->
			<tr>
				<th class="" rowspan="2" width="4.6%">编号</th>
				<td class="" rowspan="2" width="15.4%">分部分项名称</td>
				<td class="textcenter" colspan="4">材料信息</td>
				<td class="textcenter" colspan="2">价格</td>
			</tr>
			<tr>
				<td class="" width="25%">供应商</td>
				<td class="" width="21%">规格</td>
				<td class="textcenter" width="6%">单位(元)</td>
				<td class="textcenter" width="6%">数量</td>
				<td class="textcenter" width="11%" >单价</td>
				<td class="textcenter" width="11%">合计</td>
			</tr>
			<tr>	
				<th class="trtitle" colspan="8">第一部分：户内精装修</td>
			</tr>
			<tr>	
				<td class="" colspan="8"> 一、基础装修</td>
			</tr>
			<tr>
				<td></td>
				<td class="">基础装修</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textcenter">㎡</td>
				<td class="textcenter">{{data.decorationTask.actualArea}}</td>
				<td class="textright">{{data.P1 | currency:''}}</td>
				<td class="textright">{{data.X | currency:''}}</td>
			</tr>
			<tr>
				<td colspan="8" class="textright "><b class="totalbold">(基础装修小计) {{data.X | currency:''}}</b></td>
			</tr>
			<tr>
				<td class="" colspan="2">二、主材</td>
				<td class=""></td>
				<td class=""></td>
				<td class=""></td>
				<td class=""></td>
				<td class=""></td>
				<td class="textright">Y</td>
			</tr>
			<tr >
				<td colspan="8" class="section-1">

					<ul>
						<li ng-repeat="item in data.mainMaterial">
							<span>{{$index+1}}</span>
							<span>{{item.name}}</span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>	
							<br style="clear:both" />							
							<ul>
								<li ng-repeat="a in item.subList">
									<span></span>
									<span> - {{a.name}}</span>
									<span>{{a.supplier_name}}</span>
									<span>{{a.specifications}}</span>
									<span class="textcenter">{{a.unit}}</span>
									<span class="textcenter">
										<input type="text" ng-model="a.quantity" name="" ng-disabled="hasSubmit" ng-focus="clearZero($event)">
									</span>
									<span class="textright">{{a.price | currency:''}}</span>
									<span class="textright">{{(a.price*a.quantity) | currency:''}}</span>
								</li>
							</ul>
						</li>
					</ul>					
				</td>
			</tr>
			<tr>
				<td colspan="8" class="textright"><b class="totalbold">(主材小计){{data.totalPriceBean.principalTotal | currency:''}}</b></td>
			</tr>
			<tr style="background-color: #eee">
				<td colspan="7"><b class="totalbold">户内精装修小计(基础装修+主材)</b></td>	
				<td class="textright"><b class="totalbold">{{data.totalPriceBean.decorationSubtotal | currency:''}}</b></td>
			</tr>
			<!-- The second section -->
			<tr>
				<th colspan="8" class="trtitle">第二部分：绿色科技系统</th>
			</tr>

			<tr>
				<td class="section-2" colspan="8" >
					<ul>
						<li ng-repeat="item in data.greenTechnology">
							
							<span>{{$index+1}}</span>
							<span>{{item.groupProductName}}</span>
							<span></span>
							<span></span>
							<span class="textcenter">{{item.unit}}</span>
							<span>
								<input type="text" name="" ng-if="item.child==0" ng-model="item.quantity" ng-disabled="hasSubmit" ng-focus="clearZero($event)">
							</span>
							<span class="textright">
								<span ng-if="item.child==0">{{item.price | currency:''}}</span>
							</span>	
							<span class="textright">
								<span ng-if="item.child==0">{{(item.price*item.quantity) | currency:''}}</span>
							</span>						
							<ul ng-if="item.child ==1">
								<li ng-repeat="a in item.dataList">
									<span></span>
									<span>{{a.groupProductName}}</span>
									<span>{{a.supplier_name}}</span>
									<span>{{a.specifications}}</span>
									<span class="textcenter">{{a.unit}}</span>
									<span>
										<input type="text" ng-model="a.quantity" name="" ng-disabled="hasSubmit" ng-focus="clearZero($event)">
									</span>
									<span class="textright">{{a.price | currency: ''}}</span>
									<span class="textright">{{(a.price*a.quantity) | currency:''}}</span>
								</li>
							</ul>
						</li>
					</ul>
				</td>
				
			</tr>

			<tr style="background: #eee">
				<td colspan="7"><b class="totalbold">绿色科技系统小计</b></td>
				<td class="textright"><b class="totalbold">{{data.totalPriceBean.greenTechnologySubtotal | currency:''}}</b></td>

			</tr>
			<tr>
				<td></td>
				<td>材料设备采购</td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td class="textright">N</td>

			</tr>
			<tr>
				<td></td>			
				<td>设备系统施工</td>
				<td></td>
				<td></td>
				<td></td>
				<td class="textcenter">{{data.decorationTask.actualArea}}</td>
				<td class="textright">{{data.P2}}</td>
				<td class="textright">{{data.O}}</td>

			</tr>						
            <!-- The third section -->

            <tr>
				<th class="" colspan="8"> 第三部分：其他费用</th>
			</tr>
			<tr>
				<td class="">1</td>
				<td class="">完工检测费用</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textcenter">㎡</td>
				<td class="textcenter">{{data.decorationTask.actualArea}}</td>
				<td class="textright">{{data.P3}}</td>
				<td class="textright">{{data.Z}}</td>
			</tr>
			<tr style="background: #eee">
				<td colspan="7"><b class="totalbold">其他费用小计</b></td>
				<td class="textright"><b class="totalbold">{{data.Z  | currency:''}}</b></td>
			</tr>
			 <!-- The fourth section -->
			<tr>
				<th class="" colspan="8">第四部分：户内税费及利润</th>
			</tr>
			<tr>
				<td class="">1</td>
				<td class=""> 管理费（{{data.management_percent}}）</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textcenter">㎡</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textright"></td>
			</tr>
			<tr>
				<td class="">2</td>
				<td class=""> 利润  （{{data.profit_percent}}）</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textcenter">㎡</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textright">B</td>
			</tr>
			<tr>
				<td class="">3</td>
				<td class=""> 税金 （{{data.tax_percent}}）</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textcenter">㎡</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textright">C</td>
			</tr>
			<tr style="background: #eee">
				<td colspan="7"><b class="totalbold">户内税费及利润小计</b></td>
				<td class="textright"><b class="totalbold">{{(data.A+data.B+data.C)  | currency:''}}</b></td>
			</tr>


			<!-- all total -->
			<tr style="background: #eee">
				<td colspan="8" align="right">
					<b>总合计: {{data.totalPriceBean.valence | currency:'RMB ￥'}}</b>
				</td>
			</tr>
		</table>
		<div class="row" ng-if="!hasSubmit">
			<div class="btm_btn_group col-md-12">
				<button class="btn btn-default btn-lg" ng-click="edit()">保存</button>
				<button class="btn btn-primary btn-lg" ng-click="sub()">提交</button>
			</div>						
		</div>		
	</div>
	<div class="cost_detail_info main_content" ng-if="hasSubmit">
		<ol class="breadcrumb">
			<li>
				<a ui-sref="dashboard.orders({id:orderId,code:orderCode})">我的订单</a><i class="fa fa-angle-right"></i>
			</li><li class="active">
				<a ui-sref="dashboard.orders.details({id:orderId,code:orderCode})">{{currentProject}}<i class="fa fa-angle-right"></i></a>
			</li><li class="active">
				成本控制单</a>
			</li>
		</ol>
		<h3>生命屋装修成本控制单 </h3>
		<p>
			<span>项目编号：{{data.decorationTask.decorationTaskCode}}</span>&nbsp;
			<span>项目名称：{{data.decorationTask.projectName}}</span>
		</p>
		<table class="table table-bordered">
			
			<tr>
				<th class="" rowspan="2" width="4.6%">编号</th>
				<td class="" rowspan="2" width="15.4%">分部分项名称</td>
				<td class="textcenter" colspan="4">材料信息</td>
				<td class="textcenter" colspan="2" >价格</td>
			</tr>
			<tr>
				<td class="" width="25%">供应商</td>
				<td class="" width="21%">规格</td>
				<td class="textcenter" width="6%">单位</td>
				<td class="textcenter" width="6%">数量</td>
				<td class="textright" width="11%">单价</td>
				<td class="textright" width="11%">合计</td>
			</tr>
			<tr>	
				<th class="trtitle" colspan="8">第一部分：户内精装修</td>
			</tr>
			<tr>	
				<td class="" colspan="8"> 一、基础装修</td>
			</tr>
			<tr>
				<td></td>
				<td class="">基础装修</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textcenter">㎡</td>
				<td class="textcenter">{{data.decorationTask.actualArea}}</td>
				<td class="textright">{{data.P1 | currency:''}}</td>
				<td class="textright">{{data.X | currency:''}}</td>
			</tr>
			<tr>
				<td colspan="8" class="textright "><b class="totalbold">(基础装修小计) {{data.X | currency:''}}</b></td>
			</tr>
			<tr>
				<td colspan="8" class="cost_detail_info_title">二、主材</td>
				
			</tr>
			<tr >
				<td colspan="8" class="section-1">
					<ul>
						<li ng-repeat="item in data.mainMaterial">
							<span>{{$index+1}}</span>
							<span>{{item.name}}</span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>	
							<br style="clear:both" />							
							<ul>
								<li ng-repeat="a in item.subList">
									<span></span>
									<span> - {{a.name}}</span>
									<span>{{a.supplier_name}}</span>
									<span title="{{a.model}}">{{a.model}}</span>
									<span class="textcenter">{{a.unit}}</span>
									<span class="textcenter">
										<input class="inputamount" type="text" ng-model="a.quantity" name="" ng-disabled="hasSubmit" ng-focus="clearZero($event)">
									</span>
									<span class="textright">{{a.price | currency:''}}</span>
									<span class="textright">{{a.totalPrice | currency:''}}</span>
								</li>
							</ul>
						</li>
					</ul>					
				</td>

			</tr>
			<tr>
				<td colspan="8" class="textright"><b class="totalbold">(主材小计){{data.totalPriceBean.principalTotal | currency:''}}</b></td>
			</tr>
			<tr style="background-color: #eee">
				<td colspan="7"><b class="totalbold">户内精装修小计(基础装修+主材)</b></td>	
				<td class="textright"><b class="totalbold">{{data.totalPriceBean.decorationSubtotal | currency:''}}</b></td>
			</tr>

			<!-- The second section -->
			<tr>
				<th colspan="8" class="trtitle">第二部分：绿色科技系统</th>
			</tr>

			<tr>
				<td class="section-2" colspan="8" >
					<ul>
						<li ng-repeat="item in data.greenTechnology">
							
							<span>{{$index+1}}</span>
							<span>{{item.groupProductName}}</span>
							<span></span>
							<span></span>
							<span class="textcenter">{{item.unit}}</span>
							<span class="textcenter">
								<input class="inputamount" type="text" name="" ng-if="item.child==0" ng-model="item.quantity" ng-disabled="hasSubmit" ng-focus="clearZero($event)">
							</span>
							<span class="textright">
								<span  ng-if="item.child==0">{{item.price | currency:''}}</span>
							</span>	
							<span class="textright">
								<span  ng-if="item.child==0">{{item.totalPrice | currency:''}}</span>
							</span>						
							<ul ng-if="item.child ==1">
								<li ng-repeat="a in item.dataList">
									<span></span>
									<span>{{a.groupProductName}}</span>
									<span>{{a.supplier_name}}</span>
									<span>{{a.specifications}}</span>
									<span class="textcenter">{{a.unit}}</span>
									<span class="textcenter">
										<input class="inputamount" type="text" ng-model="a.quantity" name="" ng-disabled="hasSubmit" ng-focus="clearZero($event)">
									</span>
									<span class="textright">{{a.price | currency:''}}</span>
									<span class="textright">{{a.totalPrice | currency:''}}</span>
								</li>
							</ul>
						</li>
					</ul>
				</td>
				
			</tr>

			<tr style="background: #eee">
				<td colspan="7"><b class="totalbold">绿色科技系统小计</b></td>
				<td class="textright"><b class="totalbold">{{data.totalPriceBean.greenTechnologySubtotal | currency:''}}</b></td>

			</tr>
			<tr>
				<td></td>		
				<td>材料设备采购</td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td class="textright">{{data.totalPriceBean.purchasingTotal | currency:''}}</td>
			</tr>
			<tr>
				<td></td>			
				<td>设备系统施工</td>
				<td></td>
				<td></td>
				<td></td>
				<td class="textcenter">{{data.decorationTask.actualArea}}</td>
				<td class="textright">{{data.P2 | currency:''}}</td>
				<td class="textright">{{data.O | currency:''}}</td>

			</tr>						
            <!-- The third section -->

            <tr>
				<th class="" colspan="8"> 第三部分：其他费用</th>
			</tr>
			<tr>
				<td class="">1</td>
				<td class="">完工检测费用</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textcenter">㎡</td>
				<td class="textcenter">{{data.decorationTask.actualArea}}</td>
				<td class="textright">{{data.P3 | currency:''}}</td>
				<td class="textright">{{data.Z | currency:''}}</td>
			</tr>
			<tr style="background: #eee">
				<td colspan="7"><b class="totalbold">其他费用小计</b></td>
				<td class="textright"><b class="totalbold">{{data.Z  | currency:''}}</b></td>
			</tr>

			 <!-- The fourth section -->
			<tr>
				<th class="" colspan="8">第四部分：户内税费及利润</th>
			</tr>
			<tr>
				<td class="">1</td>
				<td class=""> 管理费（{{data.management_percent}}）</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textcenter">㎡</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textright">{{data.totalPriceBean.managementTotal | currency:''}}</td>
			</tr>
			<tr>
				<td class="">2</td>
				<td class=""> 利润  （{{data.profit_percent}}）</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textcenter">㎡</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textright">{{data.totalPriceBean.profitTotal | currency:''}}</td>
			</tr>
			<tr>
				<td class="">3</td>
				<td class=""> 税金 （{{data.tax_percent}}）</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textcenter">㎡</td>
				<td class=""></td>
				<td class=""></td>
				<td class="textright">{{data.totalPriceBean.taxTotal | currency:''}}</td>
			</tr>
			<tr style="background: #eee">
				<td colspan="7"><b class="totalbold">户内税费及利润小计</b></td>
				<td class="textright"><b class="totalbold">{{(data.A+data.B+data.C)  | currency:''}}</b></td>
			</tr>

			<!-- all total -->
			<tr style="background: #d6d6d6">
				<td colspan="8" align="right">
					<b>总合计: {{data.totalPriceBean.valence | currency:'RMB ￥'}}</b>
				</td>
			</tr>
		</table>
		<div class="row" ng-if="!hasSubmit">
			<div class="btm_btn_group col-md-12">
				<button class="btn btn-default btn-lg" ng-click="edit()">保存</button>
				<button class="btn btn-primary btn-lg" ng-click="sub()">提交</button>
			</div>						
		</div>		
	</div>
</div>